# Tests for SSL connections, only run if mysqld is compiled
# with support for SSL, and support TLSv1.3.

# tls_version.test vs tls_version1.test
# tls_version.test specifically tests cases when more than
# one TLS version are enabled. tls_version1.test tests cases
# when only one TLS version is enabled

-- source include/have_ssl_communication.inc
-- source include/have_tls_1_3.inc

#default is highest available version: TLSv1.3
--exec $MYSQL --host=localhost --ssl -e "show status like 'ssl_version';"
# TLSv1.3
--exec $MYSQL --host=localhost --ssl --tls_version=TLSv1.3 -e "show status like 'ssl_version';"
# TLSv1.2
--exec $MYSQL --host=localhost --ssl --tls_version=TLSv1.2 -e "show status like 'ssl_version';"
# Highest TLS version number should be used (TLSv1.3)
--exec $MYSQL --host=localhost --ssl --tls_version=TLSv1.2,TLSv1.3 -e "show status like 'ssl_version';"
# finally list available protocols
--exec $MYSQL --host=localhost --ssl -e "select @@tls_version;"
