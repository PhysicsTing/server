include/master-slave.inc
[connection master]
CREATE TABLE t1 (id INT PRIMARY KEY AUTO_INCREMENT, a INT, b INT, c INT,
UNIQUE (a), UNIQUE (b)) ENGINE=innodb;
INSERT INTO t1 (`a`,`c`) VALUES (1,1), (2,1) ON DUPLICATE KEY UPDATE c = 1;
INSERT INTO t1 (`a`,`c`) VALUES (3, 1),(2,1), (1,1) ON DUPLICATE KEY UPDATE c = 1;
SELECT * from t1;
id	a	b	c
1	1	NULL	1
2	2	NULL	1
3	3	NULL	1
connection slave;
include/diff_tables.inc [master:t1,slave:t1]
connection master;
CREATE OR REPLACE TABLE t1 (a INT, b INT, UNIQUE (a), UNIQUE (b)) ENGINE=innodb;
INSERT INTO t1 VALUES (1,10);
INSERT INTO t1 VALUES (2,20) ON DUPLICATE KEY UPDATE b = 30;
SELECT * from t1;
a	b
1	10
2	20
connection slave;
include/diff_tables.inc [master:t1,slave:t1]
connection master;
DROP TABLE t1;
connection slave;
include/rpl_end.inc
